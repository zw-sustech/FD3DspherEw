#******************************************************************************#
#*                                                                            *#
#*                                   FD3DspherEw                              *#
#*                           =========================                        *#
#*                                                                            *#
#*                        The Fortran90 Program Package                       *#
#*            for Non-Staggered Finite-Difference Seismic Wave Modeling       *#
#*                   in 3D Complex Media in Spherical Coordinate              *#
#*                                                                            *#
#*     A signed non-commercial agreement is required to use this program.     *#
#*             Free for non-commercial academic research ONLY.                *#
#*       This program is distributed WITHOUT ANY WARRANTY whatsoever.         *#
#*       Do not redistribute this program without written permission.         *#
#*                                                                            *#
#*                                                                            *#
#* Written by:                                                                *#
#*   Wei ZHANG      (wzhang07@ustc.edu.cn)                                    *#
#*   Yang Shen      (yshen@gso.uri.edu)                                       *#
#*   Xiaofei CHEN   (xfchen1@ustc.edu.cn)                                     *#
#*                                                                            *#
#* Revision History:                                                          *#
#*   2008           original version                                          *#
#*   2014/04/08     use Fortran compiler's preprocessing instead of cpp       *#
#******************************************************************************#

1 Introduction

  This program simulates seismic wave propagation in 3D complex media in
  spherical coordinate by using non-staggered finite difference method.
  We use the non-staggered FD scheme, DRP/opt MacCormack scheme
  (Hixon,1997), to update the stress-velocity wave equations.
  The traction free surface boundary condition is implemented through
  stress image method conjunction with compact scheme for velocity difference.
  In the codes, we use x as zenith(angle from south to r),
                       y as azimuth
                       z as r

2 Direcotry layout

    src/
        forward/
            source code for forward modeling
        kernel/
            source code for kernel calculation
        NR/
            source code from Numerical Recipe
        Makefie
            makefile for forward modeling
        Makefie.kernel
            makefile for kernel calculation
        make_forward.sh
            script to run make to compile forward code
        make_kernel.sh
            script to run make to compile kernel code

    mfiles/
       matlab scriptes to show the result
       #need snctools: http://mexcdf.sourceforge.net/

    README
       this file

3 Usage
  
  1) cd src, edit Makefile, Makefile.opt.LOC
        to set FC, LIB_NETCDF, MOD_NETCDF according to your system first
  2) use make_forward.sh make_kernel.sh to compile the code
     after compiling, all executable programs will be in a created
     bin/ directory here.
  3) cd run/example.media.improve/
     modify the input *.conf file
     and prepare input files,
     then execute
         ./bin/seis3d_grid or qsub pbs_grid_mpi.sh
         ./bin/seis3d_media or qsub pbs_media_mpi.sh
         ./bin/seis3d_metric or qsub pbs_metric_mpi.sh
         ./bin/seis3d_source
         ./bin/seis3d_station
         qsub pbs_wave_mpi.sh
         # the above steps valid for OpenPBS/torque job control system,
         # you should create submitting scripts according the actual job
         # control systme used. Or use mpirun directly
         # nohup mpirun -np NNN -nolocal -machinefile hostlist bin/seis3d_wave_mpi &
      Refer to README file under that directory.

# vim:ft=conf:ts=4:sw=4:nu:et:ai:
